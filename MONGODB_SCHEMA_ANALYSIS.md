# MongoDB Schema Analysis - RISARA Project

**Database:** risara
**Date:** 2025-10-12
**Collections Analyzed:** 4

---

## Executive Summary

The RISARA project uses MongoDB to store social media analytics data (TikTok) and news data for Jakarta, Indonesia. The database contains both raw data collections and AI-generated insight collections.

### Collection Overview

| Collection | Documents | Size | Purpose |
|------------|-----------|------|---------|
| tiktok_data | 12 | 0.02 MB | Raw TikTok posts with AI analysis |
| insight_tiktok_jakarta | 1 | <0.01 MB | Daily aggregated insights from TikTok |
| news_data | 111 | 1.49 MB | News articles with AI analysis |
| insight_news_jakarta | 1 | 0.01 MB | Daily aggregated insights from news |

---

## 1. Collection: tiktok_data

### Purpose
Stores TikTok posts related to Jakarta with AI-generated analytics including sentiment analysis, topic classification, and urgency scoring.

### Schema Structure

#### Core Identification Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| _id | ObjectId | MongoDB document ID | "68eb80c13ea71f3d07880d25" |
| uuid | string | Unique identifier for the post | "8fdd4662-ee88-5dbf-bfe9-078d4e404fd1" |
| link_post | string | URL to TikTok post | "https://www.tiktok.com/@jakartalk/video/7533107542944189704" |

#### User/Creator Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| username | string | TikTok username | "@jakartalk", "@vanderspoor", "@kompascom" |
| profile_link | string | URL to user profile | "https://www.tiktok.com/@jakartalk" |

#### Content Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| post_caption | string | TikTok post text/caption | "Tingkat ketimpangan ekonomi di DKI Jakarta..." |
| post_type | string | Type of post | "video" |
| thumbnail_url | string | URL to post thumbnail | "https://p16-sign-sg.tiktokcdn.com/..." |
| post_hashtags | array[string] | Hashtags used in post | ["#ketimpanganekonomi", "#jakarta"] |
| post_mentions | array[string] | User mentions in post | [] |

#### Temporal Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| post_created_at | string | Post publication date | "2025-07-31", "2025-03-23" |
| updated_at | string | Last update timestamp | "2025-10-12 17:19:34" |

#### Engagement Metrics
| Field | Type | Description | Range |
|-------|------|-------------|-------|
| like_count | number | Number of likes | 32, 503, 229 |

#### AI-Generated Analytics Fields
| Field | Type | Description | Possible Values |
|-------|------|-------------|-----------------|
| sentiment | string | Emotional tone | "Positive", "Negative", "Neutral" |
| urgency_level | number | Urgency score (0-100) | Min: 50, Max: 90, Avg: 71.25 |
| topic_classification | string | Main topic category | See Topic Categories below |
| affected_region | string | Geographic region | "DKI Jakarta", "South Jakarta", etc. |
| target_audience | array[string] | Intended audience | ["General Public", "Local Government"] |
| contextual_content | string | AI-generated summary in Indonesian | "Laporan BPS DKI Jakarta menunjukkan..." |
| contextual_keywords | array[string] | Key themes/terms | ["ketimpangan ekonomi", "rasio gini"] |
| list_word | array[string] | Extracted keywords | ["tingkat", "ketimpangan", "ekonomi"] |

#### System Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| channel | string | Source platform | "tiktok" |
| worker | number | Processing worker ID | 1, 5 |
| pinned | string | Pin status | "" (empty) |

### Topic Classifications (4 unique)
1. **Social and Economy**
2. **Government and Public Policy**
3. **Infrastructure and Transportation**
4. **Safety and Crime**

### Sentiment Distribution
- Positive
- Negative
- Neutral

### Data Quality Observations
- **Date Range:** 2022-09-08 to 2025-10-11 (3+ years of data)
- **Urgency:** Average urgency is 71.25/100, indicating generally important issues
- **Regional Coverage:** All posts currently tagged as "DKI Jakarta"
- **Engagement:** Like counts range from 32 to 503

---

## 2. Collection: insight_tiktok_jakarta

### Purpose
Daily aggregated insights generated by AI analysis of TikTok data, providing high-level summaries of trends, hashtags, locations, and mentions.

### Schema Structure

| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| _id | ObjectId | MongoDB document ID | "68eb78053ea71f3d07880ca4" |
| id | string | Date identifier | "2025-10-12" |
| date | string | Insight date | "2025-10-12" |
| insight | array[object] | AI-generated insights | See Insight Object Structure |
| total_hashtags | array[object] | Top hashtags with counts | [{"name": "jakarta", "total": 4}] |
| total_location | array[object] | Locations mentioned | [{"name": "nan", "total": 9}] |
| total_mentions | array[object] | User mentions | [{"name": "purbaya", "total": 1}] |

### Insight Object Structure
Each insight contains:
```json
{
  "main_issue": "Description of the main issue",
  "problem": "Detailed problem analysis",
  "suggestion": "Recommended actions",
  "urgency_score": 0-100,
  "topic": "Topic classification"
}
```

### Topics in Insights
- Social and Economy
- Tourism and Entertainment
- City Planning and Housing

### Data Quality Observations
- **Frequency:** Appears to be generated daily
- **Purpose:** Strategic overview for decision-makers
- **Language:** Insights are in Indonesian, providing local context

---

## 3. Collection: news_data

### Purpose
Stores news articles related to Jakarta with comprehensive AI analysis including sentiment, urgency, engagement metrics, and influence scoring.

### Schema Structure

#### Core Identification Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| _id | ObjectId | MongoDB document ID | "68eb79a33ea71f3d07880ca6" |
| uuid | string | Unique article identifier | "6f076af3-a441-52dc-bc85-2a1cd9b76301" |
| link_post | string | URL to article | "https://www.cloudflare.com/5xx-error-landing/" |

#### Content Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| title | string | Article headline | "5xx Error", "AOC can't find a union-made EV..." |
| description | string | Article description/excerpt | Full text excerpt |
| post_caption | string | Article summary | Condensed version of content |
| post_media_link | string | Media URLs (images/videos) | Array as string: "['https://...']" |

#### Source Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| username | string | Source domain | "cloudflare.com", "electrek.co" |
| creator | string | Article author | "Jameson Dow", "Jo BorrÃ¡s", "" |

#### Temporal Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| post_created_at | string | Publication datetime | "2025-10-12 16:49:19", "2023-09-27 00:00:00" |
| updated_at | string | Last update timestamp | "2025-10-12 16:49:21" |

#### Social/Metadata Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| post_hashtags | array[string] | Article hashtags | ["#vanlife"], [] |
| post_mentions | array[string] | Mentioned users | [] |
| list_quotes | string | Extracted quotes | "[]" (as string) |
| list_word | array[string] | Keywords | ["cloudflar", "protect", "websit"] |

#### AI-Generated Analytics Fields
| Field | Type | Description | Range/Values |
|-------|------|-------------|--------------|
| sentiment | string | Article sentiment | "Positive", "Negative", "Neutral" |
| urgency_level | number | Urgency score (0-100) | Min: 10, Max: 90, Avg: 48.65 |
| topic_classification | string | Main topic | See Topic Categories below |
| affected_region | string | Geographic region | "DKI Jakarta" |
| target_audience | array[string] | Intended audience | ["Technology Enthusiasts", "General Public"] |
| contextual_content | string | AI summary | "Artikel ini membahas..." |
| contextual_keywords | array[string] | Key themes | ["5xx Error", "Cloudflare"] |

#### Advanced Metrics
| Field | Type | Description | Range |
|-------|------|-------------|-------|
| engagement_rate | number | Calculated engagement score | 87.33, 118.63, 108.77 |
| influence_score | number | Article influence metric | 0.222, 8.009, 3.127 |
| reach_score | number | Estimated reach | 0.1, 4, 1.7 |
| viral_score | number | Virality metric | All samples: 0 |

#### System Fields
| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| channel | string | Source type | "news" |

### Topic Classifications (8 unique)
1. **Social and Economy**
2. **Infrastructure and Transportation**
3. **Government and Public Policy**
4. **Technology and Innovation**
5. **Environment and Disaster**
6. **Safety and Crime**
7. **Education and Culture**
8. **Ecology and Green Spaces**

### Data Quality Observations
- **Volume:** 111 articles, more data than TikTok collection
- **Date Range:** 2022-12-09 to 2025-10-12 (3 years)
- **Urgency:** Lower average urgency (48.65) than TikTok (71.25)
- **Content Size:** Larger documents (~14KB avg) vs TikTok (~2KB)
- **Engagement:** Has sophisticated multi-metric engagement tracking

---

## 4. Collection: insight_news_jakarta

### Purpose
Daily aggregated AI-generated insights from news articles, providing strategic analysis of key issues, problems, and recommendations.

### Schema Structure

| Field | Type | Description | Sample Values |
|-------|------|-------------|---------------|
| _id | ObjectId | MongoDB document ID | "68eb7bd73ea71f3d07880d1c" |
| id | string | Date identifier | "2025-10-12" |
| date | string | Insight date | "2025-10-12" |
| insight | array[object] | Detailed insights | See Insight Object Structure |

### Insight Object Structure
Each insight contains:
```json
{
  "main_issue": "English description of main issue",
  "problem": "Detailed problem analysis",
  "suggestion": "Comprehensive recommendations",
  "urgency_score": 0-100,
  "topic": "Topic classification"
}
```

### Topics in Insights
- Government and Public Policy
- Infrastructure and Transportation
- Technology and Innovation

### Sample Insight Topics
1. **Federal tax credit for EVs** (urgency: 75)
2. **EV adoption and charging infrastructure** (urgency: 75)
3. **EV charging in apartments** (urgency: 75)

### Data Quality Observations
- **Language:** Insights in English (different from TikTok insights which are in Indonesian)
- **Detail Level:** More comprehensive than TikTok insights
- **Focus:** Strategic policy and infrastructure recommendations

---

## Cross-Collection Relationships

### Shared Fields (Linking Opportunity)
All main collections share these key fields:
- **topic_classification**: Enables cross-platform topic analysis
- **sentiment**: Unified sentiment tracking across sources
- **urgency_level**: Consistent urgency scoring (0-100)
- **affected_region**: Geographic filtering
- **target_audience**: Audience segmentation
- **post_created_at**: Temporal analysis
- **contextual_keywords**: Theme tracking

### Data Flow

```
Raw Data Collections          Insight Collections
===================>          ====================>

tiktok_data                   insight_tiktok_jakarta
(12 documents)       -------> (1 document/day)

news_data                     insight_news_jakarta
(111 documents)      -------> (1 document/day)
```

### Relationship Types

1. **One-to-Many (Aggregation)**
   - Multiple TikTok posts -> Single daily TikTok insight
   - Multiple news articles -> Single daily news insight

2. **Cross-Platform (Implicit)**
   - TikTok and News data can be joined by:
     - Date (post_created_at)
     - Topic (topic_classification)
     - Region (affected_region)
     - Sentiment

---

## Analytics & Visualization Mapping

### 1. Time Series Visualizations

#### Data Sources
- **Fields:** post_created_at, urgency_level, sentiment
- **Collections:** tiktok_data, news_data

#### Possible Charts
- Line chart: Urgency trends over time
- Area chart: Sentiment distribution by day
- Multi-line: TikTok vs News volume comparison
- Heatmap: Activity by hour/day of week

### 2. Geographic Visualizations

#### Data Sources
- **Fields:** affected_region
- **Collections:** tiktok_data, news_data

#### Possible Maps
- Choropleth map: Issue count by Jakarta region
- Heat map: Urgency hotspots
- Pin map: Individual posts by location

**Note:** Currently all data is "DKI Jakarta" - need more granular data for detailed mapping

### 3. Topic Analysis

#### Data Sources
- **Fields:** topic_classification, urgency_level, sentiment
- **Collections:** tiktok_data, news_data

#### Possible Charts
- Bar chart: Top issues by topic
- Treemap: Topic distribution
- Scatter plot: Topic urgency vs engagement
- Sankey diagram: Topic -> Sentiment -> Region flow

### 4. Sentiment Analysis

#### Data Sources
- **Fields:** sentiment, topic_classification, post_created_at
- **Collections:** tiktok_data, news_data

#### Possible Charts
- Pie chart: Sentiment distribution
- Stacked bar: Sentiment by topic
- Line chart: Sentiment trends over time
- Gauge chart: Overall public sentiment score

### 5. Engagement Metrics

#### TikTok Data Sources
- **Fields:** like_count, username, post_hashtags
- **Collection:** tiktok_data

#### News Data Sources
- **Fields:** engagement_rate, influence_score, reach_score, viral_score
- **Collection:** news_data

#### Possible Charts
- Bar chart: Top engaged posts
- Bubble chart: Reach vs Influence vs Engagement
- Network graph: Hashtag co-occurrence
- Leaderboard: Top influencers/creators

### 6. Urgency Dashboard

#### Data Sources
- **Fields:** urgency_level, topic_classification, affected_region
- **Collections:** tiktok_data, news_data

#### Possible Visualizations
- KPI cards: High/Medium/Low urgency counts
- Priority matrix: Urgency vs Impact
- Alert list: Real-time critical issues (urgency >= 80)
- Trend indicator: Urgency changes week-over-week

### 7. Audience Insights

#### Data Sources
- **Fields:** target_audience, topic_classification, engagement metrics
- **Collections:** tiktok_data, news_data

#### Possible Charts
- Horizontal bar: Issues by audience segment
- Network diagram: Audience-Topic relationships
- Table: Audience prioritization matrix

### 8. Keyword/Theme Analysis

#### Data Sources
- **Fields:** contextual_keywords, post_hashtags, list_word
- **Collections:** tiktok_data, news_data, insights

#### Possible Visualizations
- Word cloud: Top keywords
- Bar chart: Trending hashtags
- Network graph: Keyword associations
- Timeline: Keyword emergence over time

### 9. AI Insights Summary

#### Data Sources
- **Fields:** insight array (main_issue, problem, suggestion, urgency_score)
- **Collections:** insight_tiktok_jakarta, insight_news_jakarta

#### Possible Displays
- Card layout: Daily insights
- Priority queue: Issues by urgency
- Recommendation tracker: Suggested actions
- Issue evolution: Problem tracking over time

### 10. Unified Monitoring Dashboard

#### Data Sources
- All fields from all collections

#### Key Metrics (From API Analysis)
- Total Posts (TikTok + News)
- Total Engagement
- Average Urgency Level
- High Priority Count (urgency >= 80)
- Critical Negative Count
- Most Critical Region
- Critical Topics Count
- Average Daily Posts
- Regional Coverage
- Citizen Reach (unique creators)
- Department Mentions
- Active Discussions
- Public Sentiment %

#### Chart Components
1. **Growth Over Time** (line chart)
   - Date vs Post Count (TikTok/News/Total)

2. **Today's Activity** (bar chart)
   - Hourly post distribution

3. **Sentiment Distribution** (pie/donut chart)
   - Urgent posts only (urgency >= 70)

4. **Topic Distribution** (bar chart)
   - Top 8 topics from urgent posts

5. **Priority Issues** (horizontal bar with color coding)
   - Topic vs Count, colored by urgency

6. **Regional Distribution** (map/bar chart)
   - Urgent posts by region

7. **Sentiment Trends** (multi-line chart)
   - Positive/Negative/Neutral over time

8. **Recent Activity Feed** (table/list)
   - Urgent posts (urgency >= 70), paginated

---

## Key Fields for Analytics

### Critical Fields (Must Have)
1. **post_created_at** - All temporal analysis
2. **urgency_level** - Priority filtering and trending
3. **sentiment** - Public mood tracking
4. **topic_classification** - Issue categorization
5. **affected_region** - Geographic insights

### High-Value Fields (Should Have)
1. **like_count** (TikTok) - Engagement proxy
2. **engagement_rate** (News) - Content performance
3. **target_audience** - Audience segmentation
4. **contextual_keywords** - Theme extraction
5. **username/creator** - Influencer identification

### Nice-to-Have Fields
1. **influence_score** (News) - Impact measurement
2. **reach_score** (News) - Audience size
3. **post_hashtags** - Trend tracking
4. **worker** - System monitoring

---

## Data Quality Issues & Recommendations

### Current Issues

1. **Limited Regional Granularity**
   - All data currently tagged as "DKI Jakarta"
   - Recommendation: Enhance AI to extract specific sub-regions (South Jakarta, North Jakarta, etc.)

2. **Small TikTok Dataset**
   - Only 12 documents
   - Recommendation: Increase data collection frequency/scope

3. **Inconsistent Date Formats**
   - TikTok: "YYYY-MM-DD"
   - News: "YYYY-MM-DD HH:MM:SS"
   - Recommendation: Standardize to ISO 8601

4. **Empty/Sparse Fields**
   - Many post_mentions, post_hashtags are empty arrays
   - list_quotes stored as string "[]" instead of array
   - Recommendation: Improve extraction algorithms

5. **Missing Engagement Data**
   - TikTok: Only like_count (missing comments, shares, views)
   - Recommendation: Expand metric collection if API allows

### Enhancement Opportunities

1. **Add Computed Fields**
   - engagement_score (normalized across platforms)
   - trend_velocity (rate of urgency change)
   - issue_maturity (days since first mention)

2. **Relationship Collection**
   - Track issue evolution across posts
   - Link related posts by theme/keywords

3. **User/Creator Collection**
   - Aggregate creator statistics
   - Influencer scoring and tracking

4. **Historical Snapshots**
   - Archive daily insight summaries
   - Track long-term trend evolution

---

## API Integration Points

Based on the codebase analysis, these collections are accessed through:

### API Routes
1. **/api/unified-monitoring** - Cross-platform analytics
2. **/api/dashboard** - Source-specific metrics (news or tiktok)
3. **/api/trending** - Trending topics and insights
4. **/api/analytics/twitter** - Analytics endpoint (appears to use TikTok data)

### Key Query Patterns

1. **Date Range Filtering**
   ```javascript
   { post_created_at: { $gte: startDate, $lte: endDate } }
   ```

2. **Urgency Filtering**
   ```javascript
   { urgency_level: { $gte: 70 } }  // Urgent posts
   { urgency_level: { $gte: 80 } }  // High priority
   ```

3. **Sentiment + Urgency**
   ```javascript
   { urgency_level: { $gte: 80 }, sentiment: 'negative' }
   ```

4. **Aggregation Examples**
   - Group by topic_classification
   - Group by affected_region
   - Group by date (daily rollups)
   - Count by sentiment

---

## Visualization Implementation Guide

### High-Priority Dashboards

#### 1. Executive Overview
**Purpose:** Quick situational awareness
**Update Frequency:** Real-time
**Key Metrics:**
- Total urgent issues (urgency >= 80)
- Trending topics (last 24h)
- Sentiment gauge
- Critical regions

**Data Fields:**
```javascript
{
  urgency_level: number,
  sentiment: string,
  topic_classification: string,
  affected_region: string,
  post_created_at: string
}
```

#### 2. Issue Tracker
**Purpose:** Monitor specific problems over time
**Update Frequency:** Daily
**Key Features:**
- Filter by topic/region/urgency
- Timeline view
- Issue evolution tracking

**Data Fields:**
```javascript
{
  uuid: string,
  title/post_caption: string,
  urgency_level: number,
  sentiment: string,
  post_created_at: string,
  contextual_keywords: array
}
```

#### 3. Engagement Analytics
**Purpose:** Measure content resonance
**Update Frequency:** Hourly
**Key Features:**
- Top performing posts
- Engagement trends
- Audience breakdown

**Data Fields:**
```javascript
// TikTok
{ like_count, username, post_hashtags }

// News
{ engagement_rate, influence_score, reach_score }
```

#### 4. Regional Heatmap
**Purpose:** Geographic issue distribution
**Update Frequency:** Daily
**Key Features:**
- Jakarta region overlay
- Issue density
- Urgency color coding

**Data Fields:**
```javascript
{
  affected_region: string,
  urgency_level: number,
  topic_classification: string
}
```

**Note:** Requires enhanced regional data collection

#### 5. AI Insights Dashboard
**Purpose:** Strategic recommendations
**Update Frequency:** Daily
**Key Features:**
- Prioritized issue list
- Problem summaries
- Action recommendations

**Data Source:**
```javascript
// insight_tiktok_jakarta / insight_news_jakarta
{
  insight: [{
    main_issue: string,
    problem: string,
    suggestion: string,
    urgency_score: number,
    topic: string
  }]
}
```

---

## Sample Queries for Common Use Cases

### 1. Get Critical Issues from Last 7 Days
```javascript
db.tiktok_data.find({
  urgency_level: { $gte: 80 },
  post_created_at: {
    $gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()
  }
}).sort({ urgency_level: -1, post_created_at: -1 })
```

### 2. Topic Sentiment Distribution
```javascript
db.news_data.aggregate([
  {
    $group: {
      _id: { topic: '$topic_classification', sentiment: '$sentiment' },
      count: { $sum: 1 }
    }
  },
  { $sort: { '_id.topic': 1, count: -1 } }
])
```

### 3. Daily Urgency Trends
```javascript
db.tiktok_data.aggregate([
  {
    $group: {
      _id: { $substr: ['$post_created_at', 0, 10] },
      avgUrgency: { $avg: '$urgency_level' },
      count: { $sum: 1 }
    }
  },
  { $sort: { _id: 1 } }
])
```

### 4. Top Engaged TikTok Posts
```javascript
db.tiktok_data.find({
  urgency_level: { $gte: 70 }
}).sort({ like_count: -1 }).limit(10)
```

### 5. Cross-Platform Topic Comparison
```javascript
// TikTok topics
db.tiktok_data.aggregate([
  { $group: { _id: '$topic_classification', count: { $sum: 1 } } },
  { $sort: { count: -1 } }
])

// News topics
db.news_data.aggregate([
  { $group: { _id: '$topic_classification', count: { $sum: 1 } } },
  { $sort: { count: -1 } }
])
```

### 6. Keyword Trend Analysis
```javascript
db.tiktok_data.aggregate([
  { $unwind: '$contextual_keywords' },
  { $group: { _id: '$contextual_keywords', count: { $sum: 1 } } },
  { $sort: { count: -1 } },
  { $limit: 20 }
])
```

---

## Conclusion

The RISARA MongoDB database provides a solid foundation for social media and news analytics focused on Jakarta. The schema is well-structured with consistent AI-generated fields across collections, enabling comprehensive cross-platform analysis.

### Strengths
1. Consistent schema design across TikTok and news data
2. Rich AI-generated metadata (sentiment, urgency, topics)
3. Daily insight aggregations for strategic overview
4. Multi-dimensional analytics (engagement, influence, reach)

### Areas for Improvement
1. Increase data collection volume (especially TikTok)
2. Enhance regional granularity
3. Add more engagement metrics
4. Improve keyword/hashtag extraction
5. Add creator/influencer tracking

### Next Steps for Visualization
1. Build unified monitoring dashboard using urgency >= 70 threshold
2. Implement regional heatmap (pending enhanced region data)
3. Create time-series trend visualizations
4. Develop AI insights interface
5. Build engagement leaderboards
